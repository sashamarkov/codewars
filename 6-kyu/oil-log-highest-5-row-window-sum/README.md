<h2><a href=https://www.codewars.com/kata/69306b1b1f66b468e914f946/train/sql target="_blank">Oil Log: Highest 5-Row Window Sum</a></h2><h3>6 kyu</h3><p>Oil companies collect thousands of downhole measurements while drilling.One of the most common logs is a depth-indexed signal (such as gamma ray, density, resistivity, or the simplified ktim value here). Each reading corresponds to a specific depth in the well, and the wells are always logged from shallow to deep.</p><p>Geologists often want to identify the strongest continuous intervals in the well.In this kata, an interval is defined as exactly 5 consecutive depth readings.</p><p>You are given a database table named <code>well_log</code>, with the following structure:</p><ul><li><code>id</code> (int): primary key</li><li><code>depth</code> (float): the measured depth, always increasing.</li><li><code>ktim</code> (float): the signal amplitude at that depth.</li></ul><p>Your task is to write a SQL query that:</p><p>Computes every 5-reading interval, calculates its total ktim value, and returns all intervals sorted by total ktim in descending order.</p><p>This allows a geologist to quickly locate the most promising zones.</p><p><strong>Output Columns</strong></p><p>Your query must return one row per interval, containing:</p><ol><li><code>start_depth</code> (float) — depth of the first reading in the interval</li><li><code>end_depth</code> (float) — depth of the fifth reading</li><li><code>total_ktim</code> (varchar) — sum of ktim values across the 5 adjacent rows, rounded to two decimals for clean presentation. Ordering must be based on its numeric value, not lexicographic string order.</li></ol><p><strong>Rules &amp; Requirements</strong></p><ol><li>Each interval must include <b>exactly</b> 5 adjacent rows, ordered by depth.</li><li>All possible intervals must be returned. It is quaranteed that there will be more than 5 raws in the table.</li><li>Result must be sorted by <code>total_ktim</code> DESC, strongest first. If two intervals have the same total_ktim, the one with the lower <code>start_depth</code> must come first.</li></ol><p>For this sample data: </p><pre><code>| depth   | ktim    |+---------+---------+| 6999.0  | 576.46  || 6999.5  | 892.10  || 7000.0  | 10.12   || 7000.5  | 22.07   || 7001.0  | 186.55  || 7001.5  | 577.98  || 7002.0  | 799.42  || 7002.5  | 334.15  || 7003.0  | 99.43   || 7003.5  | 111.43  || 7004.0  | 41.94   |</code></pre><p>expected output is the following:</p><pre><code>| start_depth | end_depth | total_ktim |+-------------+-----------+------------+| 7001.0      | 7003.0    | 1997.53    || 7001.5      | 7003.5    | 1922.41    || 7000.5      | 7002.5    | 1920.17    || 6999.5      | 7001.5    | 1688.82    || 6999.0      | 7001.0    | 1687.30    || 7000.0      | 7002.0    | 1596.14    || 7002.0      | 7004.0    | 1386.37    |</code></pre><p>GLHF!</p>