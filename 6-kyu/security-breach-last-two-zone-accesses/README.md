<h2><a href=https://www.codewars.com/kata/692752ec3bfcc5bfac61abb9/train/sql target="_blank">Security Breach: Last Two Zone Accesses</a></h2><h3>6 kyu</h3><p>You are working as a data analyst for a high-security research facility.Recently, an internal security breach occurred — classified information was leaked from somewhere inside the building.</p><p>Investigators have discovered a key clue:</p><p><b>The person responsible accessed two different security zones, one right after the other, and the time gap between those two accesses is crucial for reconstructing the event timeline.</b></p><p>Your job is to analyze badge-swipe logs stored in a table called <code>access_logs</code>.</p><p>The table has the following structure:</p><ul><li><code>id</code> (int): Primary key</li><li><code>employee_id</code> (int): The ID of the employee who swiped their badge</li><li><code>zone</code> (varchar): The security zone they entered</li><li><code>access_time</code> (timestamp): The exact moment the badge was used to enter the zone</li></ul><p>Each row represents a single door swipe made by an employee.</p><p><strong>Your Task</strong></p><p>Write a SQL query that determines, for each employee, the time difference (in seconds) between their two most recent badge swipes into two different security zones.</p><p>Only employees who have accessed at least two different zones should appear in the result.</p><p>Output Columns:</p><ol><li><code>employee_id</code> – The employee’s ID</li><li><code>seconds_diff</code> – The absolute time difference (in seconds) between the timestamps of their two most recent different-zone accesses</li></ol><p>Results must be ordered first by <code>seconds_diff</code> in ascending order, and then by <code>employee_id</code> in ascending order when multiple employees have the same time difference.</p><p>Notes:</p><ol><li>Each entry in <code>access_logs</code> represents a single badge swipe; duplicates do not occur in this system.</li><li>Only different zones count — two most recent accesses to the same zone must not be paired.</li><li>An employee must have accessed at least two different zones (two or more), not exactly two — if they accessed three, four, or more zones, the two most recent distinct zones should still be used.</li><li>For each zone, only the most recent access time is relevant.</li><li>The time difference must always be returned as a non-negative number of seconds.</li><li>Each employee must appear only once in the output.</li><li>The underlying table is partitioned by day, and each query operates on a single day’s partition, so you do not need to filter by date or apply any additional time-range conditions.</li><li>It is guaranteed by the facility’s access control system that no employee can swipe into two different zones at the exact same timestamp, so identical <code>access_time</code> values for different zones will never occur.</li></ol><p>For the following sample data:</p><pre><code>| employee_id |     zone     |      access_time        |+-------------+--------------+-------------------------+|     1       |   Alpha      | 2023-06-01 12:00:00     ||     1       |   Beta       | 2023-06-01 12:03:00     ||     1       |   Alpha      | 2023-06-01 12:04:00     ||     2       |   Gamma      | 2023-06-01 09:10:00     ||     2       |   Gamma      | 2023-06-01 09:12:00     ||     2       |   Delta      | 2023-06-01 09:15:00     ||     3       |   Omega      | 2023-06-01 14:00:00     |</code></pre><p>Expected output is:</p><pre><code>| employee_id | seconds_diff |+-------------+--------------+|      1      |      60      ||      2      |     180      |</code></pre><p>GLHF!</p>